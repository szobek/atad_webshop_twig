<div class="cookie-alert{% if close %} cookie_alert_close{% endif %}{% if allow %} cookie_alert_allow{% endif %} cookie_alert_3" id="cookie_alert"
    role="region" aria-label="{{ text.cookie_consent_settings }}" aria-describedby="cookie_alert_description" tabindex="-1"
>
    <div class="cookie-alert__inner py-4 border-top" id="cookie_alert_open">
        <div class="container">
            <div class="row align-items-lg-end row-gap-10">
                <div class="col-lg">
                    <div id="cookie_alert_title" class="cookie-alert__title font-weight-bold">{{ text.cookie_consent_settings }}</div>
                    <div id="cookie_alert_description" class="cookie-alert__text font-s">{{ text.cookie_consent_text_1 }}</div>
                </div>
                <div class="col-lg-auto">
                    <div class="cookie-alert__btns text-center text-lg-right">
                        <button class="cookie-alert__btn-allow btn btn-primary icon--a-check" type="button" onclick="cookie_alert_action(1,1)">{{ text.button_ok }}</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function() {
            $(".cookie-alert__btn-open").show();

            function consentFocusHandling() {
                const $overlay = $('#cookie_alert');
                const $focusableElements = $overlay.find('button, input:not([disabled]), a[href]:not([href="#"]):not(.close)');

                if ($focusableElements.length === 0) {
                    return;
                }

                const $firstElement = $focusableElements.first();
                const $lastElement = $focusableElements.last();

                $overlay.off('keydown.focustrap').on('keydown.focustrap', function(event) {
                    if (event.key === 'Tab' || event.keyCode === 9) {
                        if (event.shiftKey) {
                            if (document.activeElement === $firstElement[0] || document.activeElement === $overlay[0]) {
                                event.preventDefault();
                                $lastElement.focus();
                            }
                        } else {
                            if (document.activeElement === $lastElement[0]) {
                                event.preventDefault();
                                $firstElement.focus();
                            }
                        }
                    }
                });
                window.announceToScreenReader?.('modalOpen',{'label': `{{ text.cookie_consent_settings }}`});
                setTimeout(function () {
                    $overlay.focus();
                }, 1000);
            }

            {% if not close %}
            consentFocusHandling();
            {% endif %}

            $(document).on("openConsent", function () {
                consentFocusHandling();
            });
            $(document).on("closeConsent", function () {
                window.announceToScreenReader?.('modalClose',{'label': `{{ text.cookie_consent_settings }}`});
            });
            $(document).on("grantConsent", function () {
                window.announceToScreenReader?.('grantConsent');
            });
            $(document).on("rejectConsent", function () {
                window.announceToScreenReader?.('rejectConsent');
            });
        });
    </script>
</div>